<div id="app">
    <div class="container d-flex justify-content-between">
        <!--側欄-->
        <div class="col-md-2">
            <div class="d-grid gap-3">
                <button class="btn btn-info" type="button" v-on:click="getCompetiton">我的比賽</button>
                <button class="btn btn-info" type="button" v-on:click="getVote">我支持的選手</button>
                <button class="btn btn-info" type="button" v-on:click="getFavorite">我的收藏</button>
            </div>
        </div>
        <!--主要內容-->
        <div class="col-md-9">
        
            <div>
                <ul class="list-group">
                    <!--我的比賽-->
                    <li class="list-group-item d-flex justify-content-between" v-for="item in myCompetition" :key="item.id">
                        <div>
                            <img v-bind:src="getPhoto(item.competitionPhotos)" style="width:200px;height:150px" />
                        </div>
                        <div>
                            <h5>{{item.competitionName}}</h5>
                            <p>活動時間：{{item.startTime}} ~ {{item.endTime}}</p>
                        </div>
                        <span>{{item.statement}}</span>
                    </li>

                    <!--我投票的選手-->
                    <li class="list-group-item" v-for="item in myVote" :key="item.voteid">
                        <div class="d-flex justify-content-between">
                        <h3>{{item.competitionName}}</h3>
                            <span>{{item.statement}}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <img v-bind:src="getPhoto(item.competitorPhoto)" style="width:200px;height:150px" />
                            <div>
                            <h5>{{item.competitorName}}</h5>
                            <p>{{item.content}}</p>
                            </div>
                            <button class="btn btn-secondary" type="button">取消投票</button>
                        </div>
                    </li>

                    <!--我收藏的比賽-->
                    <li class="list-group-item" v-for="item in myFavorite" :key="item.favoriteId">
                        <div class="d-flex justify-content-between">
                            <h3>{{item.competitionName}}</h3>
                            <span>{{item.statement}}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <img v-bind:src="getPhoto(item.competitionPhoto)" style="width:200px;height:150px" />
                            <div>
                                <h5>活動時間：{{item.startTime}} ~ {{item.endTime}}</h5>
                                <p>{{item.competitionContent}}</p>
                            </div>
                            <button class="btn btn-secondary" type="button">取消收藏</button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- axios -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js"
        integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    var userAccount = "user5";
    //var userAccount = sessionStorage.getItem("username");
    var vueApp = {
        data() {
            return {
                myCompetition:[],
                myVote:[],
                myFavorite:[],
            };
        },
        methods:{
            getCompetiton: function () {
                let _this = this;
                try {
                    axios.get(`https://localhost:7292/api/OnlineCompetitions/MyCompetition/${userAccount}`)
                        .then(response => {
                            _this.myCompetition = response.data;
                        });
                    console.log(_this.CompetitionName)
                }
                catch (error) {
                    console.log(error)
                }
            },
            getPhoto: function (competitionPhotos) {
                return competitionPhotos != null ? `https://localhost:7000/uploads/${competitionPhotos}`: `https://localhost:7000/image/noimage.jpg`;
            },
            getVote:function(){
                let _this = this;
                try {
                    axios.get(`https://localhost:7292/api/OnlineCompetitions/MyVote/${userAccount}`)
                        .then(response => {
                            _this.myVote = response.data;
                        });
                }
                catch(error) {
                    console.log(error)
                }
            },
            getFavorite:function(){
                let _this = this;
                try {
                    axios.get(`https://localhost:7292/api/OnlineCompetitions/MyFavorite/${userAccount}`)
                        .then(response => {
                            _this.myFavorite = response.data;
                        });
                }
                catch(error) {
                    console.log(error)
                }
            },
        },

    }
    var app = Vue.createApp(vueApp).mount("#app");

</script>